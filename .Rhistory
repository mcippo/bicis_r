library(dplyr)
barrios <- read.csv("barrios_caba.csv")
View(barrios)
writexl::write_xlsx(barrios,"barrios.xlsx")
estaciones <- read.csv("nuevas-estaciones-bicicletas-publicas.csv")
View(estaciones)
x <- estaciones %>% group_by(numero_de_estacion) %>% mutate(casos=n())
View(x)
View(x)
x <- estaciones %>% group_by(numero_de_estacion) %>% summarise(casos=n())
View(x)
x_2 <- estaciones %>% group_by(id) %>% summarise(casos=n())
View(x_2)
listado_estaciones <- estaciones %>% select(id,latitud,longitud)
View(listado_estaciones)
writexl::write_xlsx(listado_estaciones,"estaciones_barrio.xlsx")
library(tidyverse)
read_sf
library(sf)
barrios <- read_sf("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/ministerio-de-educacion/barrios/barrios.geojson")
View(barrios)
write_sf(barrios,"barrios_poli.geojson")
df <- read_excel("estaciones_barrio.xlsx")
# Paso 1: Leer Excel con coordenadas
df <- read_xlsx("estaciones_barrio.xlsx")
library(sf)
library(readxl)
library(dplyr)
library(openxlsx)
# Paso 1: Leer Excel con coordenadas
df <- read_x("estaciones_barrio.xlsx")
# Paso 1: Leer Excel con coordenadas
df <- read.xlsx("estaciones_barrio.xlsx")
# Convertir a objeto espacial
puntos <- st_as_sf(df, coords = c("longitud", "latitud"), crs = 4326)
View(x)
View(puntos)
# Paso 2: Leer archivo GeoJSON de barrios
barrios <- st_read("barrios.geojson")
# Paso 3: Unión espacial (intersección punto dentro de polígono)
puntos_con_barrios <- st_join(puntos, barrios[, c("barrio")], join = st_within)
puntos_con_barrios <- st_join(puntos, barrios[, c("barrio")], join = st_within)
barrios <- st_read("barrios.geojson")
puntos_con_barrios <- st_join(puntos, barrios[, c("barrio")], join = st_within)
barrios <- read_sf("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/ministerio-de-educacion/barrios/barrios.geojson")
View(barrios)
barrios <- read_sf("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/ministerio-de-educacion/barrios/barrios.geojson") %>%
rename(barrio=nombre)
View(barrios)
write_sf(barrios,"barrios_poli.geojson")
# Paso 2: Leer archivo GeoJSON de barrios
barrios <- st_read("barrios.geojson")
puntos_con_barrios <- st_join(puntos, barrios[, c("barrio")], join = st_within)
barrios <- read_sf("https://cdn.buenosaires.gob.ar/datosabiertos/datasets/ministerio-de-educacion/barrios/barrios.geojson") %>%
rename(barrio=nombre)
write_sf(barrios,"barrios_poli.geojson")
write_sf(barrios,"barrios_poli.geojson")
View(barrios)
puntos_con_barrios <- st_join(puntos, barrios[, c("barrio")], join = st_within)
# Paso 4: Guardar resultado a Excel
puntos_final <- puntos_con_barrios %>%
st_drop_geometry()  # quitamos la geometría para guardar como tabla
View(puntos_final)
write.xlsx(puntos_final, "estaciones_con_barrios.xlsx")
estaciones <- read.csv("nuevas-estaciones-bicicletas-publicas.csv")
barrios_est <- readxl::read_xlsx("asignacion_barrios_estaciones.R")
barrios_est <- readxl::read_xlsx("estaciones_con_barrios.xlsx")
barrios_est <- readxl::read_xlsx("estaciones_barrio.xlsx")
View(barrios_est)
barrios_est <- readxl::read_xlsx("estaciones_con_barrios.xlsx.xlsx")
View(barrios_est)
barrios_est <- readxl::read_xlsx("estaciones_con_barrios.xlsx.xlsx")
barrios_est <- readxl::read_xlsx("estaciones_con_barrios.xlsx")
View(barrios_est)
View(estaciones)
listado_estaciones_final <-  estaciones %>%
select(-(barrio,comuna,emplazamiento))
listado_estaciones_final <-  estaciones %>%
select(-c(barrio,comuna,emplazamiento))
listado_estaciones_final <-  estaciones %>%
select(-c(barrio,comuna,emplazamiento)) %>%
left_join(barrios_est)
View(listado_estaciones_final)
chequeo <- listado_estaciones_final %>% filter(is.na(barrio))
View(chequeo)
listado_estaciones_final <- listado_estaciones_final %>%
mutate(barrio=case_when(nombre=="AEROPARQUE"~"Palermo",
nombre=="MACACHA GUEMES"~"Belgrano",
TRUE~barrio))
View(listado_estaciones_final)
listado_estaciones_final <- listado_estaciones_final %>%
mutate(barrio=case_when(nombre=="AEROPARQUE"~"Palermo",
nombre=="MACACHA GUEMES"~"Belgrano",
TRUE~barrio)) %>%
select(everything(),latitud,longitud)
View(listado_estaciones_final)
estaciones <- read.csv("nuevas-estaciones-bicicletas-publicas.csv")
barrios_est <- readxl::read_xlsx("estaciones_con_barrios.xlsx")
listado_estaciones_final <-  estaciones %>%
select(-c(barrio,comuna,emplazamiento)) %>%
left_join(barrios_est)
chequeo <- listado_estaciones_final %>% filter(is.na(barrio))
# Asignación manual de NAS:
listado_estaciones_final <- listado_estaciones_final %>%
mutate(barrio=case_when(nombre=="AEROPARQUE"~"Palermo",
nombre=="MACACHA GUEMES"~"Belgrano",
TRUE~barrio))
View(listado_estaciones_final)
listado_estaciones_final <- listado_estaciones_final %>%
mutate(barrio=case_when(nombre=="AEROPARQUE"~"Palermo",
nombre=="MACACHA GUEMES"~"Belgrano",
TRUE~barrio)) %>%
select(1:4,7,5,6)
listado_estaciones_final <- listado_estaciones_final %>%
mutate(barrio=case_when(nombre=="AEROPARQUE"~"Palermo",
nombre=="MACACHA GUEMES"~"Belgrano",
TRUE~barrio)) %>%
select(1:4,7,5,6) %>%
arrange(id)
View(listado_estaciones_final)
estaciones <- read.csv("nuevas-estaciones-bicicletas-publicas.csv")
barrios_est <- readxl::read_xlsx("estaciones_con_barrios.xlsx")
listado_estaciones_final <-  estaciones %>%
select(-c(barrio,comuna,emplazamiento)) %>%
left_join(barrios_est)
chequeo <- listado_estaciones_final %>% filter(is.na(barrio))
# Asignación manual de NAS:
listado_estaciones_final <- listado_estaciones_final %>%
mutate(barrio=case_when(nombre=="AEROPARQUE"~"Palermo",
nombre=="MACACHA GUEMES"~"Belgrano",
TRUE~barrio))
View(estaciones)
View(listado_estaciones_final)
listado_estaciones_final <- listado_estaciones_final %>%
mutate(barrio=case_when(nombre=="AEROPARQUE"~"Palermo",
nombre=="MACACHA GUEMES"~"Belgrano",
TRUE~barrio)) %>%
select(1:4,7,5,6)
View(listado_estaciones_final)
estaciones <- read.csv("nuevas-estaciones-bicicletas-publicas.csv")
barrios_est <- readxl::read_xlsx("estaciones_con_barrios.xlsx")
listado_estaciones_final <-  estaciones %>%
select(-c(barrio,comuna,emplazamiento)) %>%
left_join(barrios_est)
chequeo <- listado_estaciones_final %>% filter(is.na(barrio))
# Asignación manual de NAS:
listado_estaciones_final <- listado_estaciones_final %>%
mutate(barrio=case_when(nombre=="AEROPARQUE"~"Palermo",
nombre=="MACACHA GUEMES"~"Belgrano",
TRUE~barrio)) %>%
select(1:4,7,5,6) %>%
arrange(id)
View(listado_estaciones_final)
barrio <- read_xlsx("tabla_barrios.xlsx")
View(barrio)
barrio <- read_xlsx("tabla_barrios.xlsx") %>%
select(barrio,id_barrio)
View(barrio)
listado_estaciones_final <- listado_estaciones_final %>%
left_join(barrio)
View(listado_estaciones_final)
x <- listado_estaciones_final %>% filter(is.na(id_barrio))
View(x)
estaciones <- read.csv("nuevas-estaciones-bicicletas-publicas.csv")
barrios_est <- readxl::read_xlsx("estaciones_con_barrios.xlsx")
listado_estaciones_final <-  estaciones %>%
select(-c(barrio,comuna,emplazamiento)) %>%
left_join(barrios_est)
chequeo <- listado_estaciones_final %>% filter(is.na(barrio))
# Asignación manual de NAS:
listado_estaciones_final <- listado_estaciones_final %>%
mutate(barrio=case_when(nombre=="AEROPARQUE"~"Palermo",
nombre=="MACACHA GUEMES"~"Belgrano",
TRUE~barrio)) %>%
select(1:4,7,5,6) %>%
arrange(id)
barrio <- read_xlsx("tabla_barrios.xlsx") %>%
select(barrio,id_barrio)
listado_estaciones_final <- listado_estaciones_final %>%
left_join(barrio)
x <- listado_estaciones_final %>% filter(is.na(id_barrio))
View(x)
estaciones <- read.csv("nuevas-estaciones-bicicletas-publicas.csv")
barrios_est <- readxl::read_xlsx("estaciones_con_barrios.xlsx")
listado_estaciones_final <-  estaciones %>%
select(-c(barrio,comuna,emplazamiento)) %>%
left_join(barrios_est)
chequeo <- listado_estaciones_final %>% filter(is.na(barrio))
# Asignación manual de NAS:
listado_estaciones_final <- listado_estaciones_final %>%
mutate(barrio=case_when(nombre=="AEROPARQUE"~"Palermo",
nombre=="MACACHA GUEMES"~"Belgrano",
TRUE~barrio)) %>%
select(1:4,7,5,6) %>%
arrange(id)
# Ahora se asigna un id_barrio:
barrio <- read_xlsx("tabla_barrios.xlsx") %>%
select(barrio,id_barrio)
listado_estaciones_final <- listado_estaciones_final %>%
left_join(barrio)
x <- listado_estaciones_final %>% filter(is.na(id_barrio))
rm(x)
View(listado_estaciones_final)
writexl::write_xlsx(listado_estaciones_final,"estaciones.xlsx")
usuarios <- read.csv("usuarios_ecobici_2024.csv")
View(usuarios)
recorridos <- readRDS("recorridos_2024.rds")
